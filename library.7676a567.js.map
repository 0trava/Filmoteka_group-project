{"mappings":"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","sources":["src/js/watched-queue-run.js","src/js/modal-library.js"],"sourcesContent":["import { watched, queue } from './local-storage';\nimport {getGenrelibrary} from './generes';\n\n// import { getMovieInfoById } from './api-service';\n\nconst API_KEY = '34e68a416eb051ec4adf34df5a0038fd';\nconst API_URL = `https://api.themoviedb.org/3/`;\nconst API_URL_IMG = `https://image.tmdb.org/t/p/original`;\n\nconst libWatchedBtn = document.querySelector('.library-btn__watched');\nconst libQueueBtn = document.querySelector('.library-btn__queue');\nconst libContainer = document.querySelector('.library-gallery-wrap');\nconst libBoxinfo = document.querySelector('.library-bg-image');\nconst BoxCard = document.querySelector('.library-gallery-box');\nconst spinner = document.querySelector('.dot-spinner');\n\nlibWatchedBtn.addEventListener('click', onlibWatchedBtnClick);\nlibQueueBtn.addEventListener('click', onlibQueueBtnClick);\nwindow.addEventListener('load', onlibWatchedBtnClick);\n\n\n// НАТИСК на кнопку - Watched\nasync function onlibWatchedBtnClick() {\n  if (watched.length === 0) {\n    console.log(\"start\");\n    libBoxinfo.classList.remove('is-hidden');\n    BoxCard.innerHTML = ``;\n    return \n\n\n  };\n\n  spinner.classList.remove('is-hidden');\n  spinner.classList.add('is-hidden');\n\n  renderList(watched);\n}\n\n\n// НАТИСК на кнопку - Queue\nasync function onlibQueueBtnClick() {\n  if (queue.length === 0)  {\n    console.log(\"start\");\n    libBoxinfo.classList.remove('is-hidden');\n    BoxCard.innerHTML = ``;\n    return \n\n\n  };\n\n  spinner.classList.remove('is-hidden');\n  spinner.classList.add('is-hidden');\n\n  renderList(queue);\n}\n\nasync function getMovieInfoById(movieID) {\n  const resp = await fetch(\n    `${API_URL}movie/${movieID}?api_key=${API_KEY}&language=en-US`\n  );\n\n  const respData = await resp.json();\n\n  return respData;\n}\n\nasync function getMoviesList(array) {\n  const moviePromises = array.map(item => getMovieInfoById(item));\n  const moviesList = await Promise.all(moviePromises);\n  return moviesList;\n}\n\nexport async function renderList(array) {\n  const moviesList = await getMoviesList(array);\n  const watchedList = createList(moviesList);\n  libBoxinfo.classList.add('is-hidden');\n  BoxCard.innerHTML = '';\n  BoxCard.insertAdjacentHTML('beforeend', watchedList);\n}\n\nfunction createList(array) {\n  return array.reduce((acc, item) => {\n    return acc + createMarkup(item);\n  }, '');\n}\n\nfunction createMarkup(item) {\n  // console.log(item);\n\n        let test = getGenrelibrary(item.genres);\n\n        // let item.year = release_date?.substring(0, 4);\n  return `\n            <li class=\"movie-card\"  ID=${item.id}>\n                <img class=\"movie-card__image\" src=\"${API_URL_IMG}${item.poster_path}\" \n                onerror=\"this.onerror=null;this.src='https://thumbs.dreamstime.com/b/атрибуты-кино-вьюрок-фи-ьма-и-во-а-со-ы-в-бумажном-стаканчике-87336791.jpg'\" \n                alt=\"${item.original_title}\" \n                width=\"300\"\n                ID=${item.id}>\n                <h2 class=\"movie-card__name\"   ID=${item.id}>${item.original_title}</h2>\n                <p class=\"movie-card__text\"   ID=${item.id}>${test} | ${item.release_date?.substring(0, 4)}</p>\n            </li>\n        `;\n}\n","// import * as apiService from './api-service';\nimport {\n  watched,\n  queue,\n  getQueue,\n  getWatched,\n  setQueue,\n  setWatched,\n} from './local-storage';\nimport { renderList } from './watched-queue-run';\n\nconst backdropModal = document.querySelector('.backdrop');\nconst API_KEY = '34e68a416eb051ec4adf34df5a0038fd';\nconst API_URL=`https://api.themoviedb.org/3/`;\nconst API_URL_IMG=`https://image.tmdb.org/t/p/original`;\n\nconst refs = {\n  gallerySelector: document.querySelector('.library-gallery-wrap'),\n  closeButton: document.querySelector('.modal__button-close'),\n\n};\n\n \n\n\n\n\nwindow.addEventListener('keydown', closeModalHandler);\n// window.addEventListener('click', onCloseButton);\nrefs.closeButton.addEventListener('click', onCloseButton);\nrefs.gallerySelector.addEventListener('click', showCard);\n\n\n// зачинення по кліку поза модалкою\n\nconst modal = document.querySelector('.modal');\n\n\n// добавляем обработчик клика на весь документ\n\n// ->>>>>>\n\n\nfunction closeModalHandler(evt) {\n  if (evt.code === 'Escape') {\n    backdropModal.classList.add('is-hidden');\n  }\n  //зняття слухачів\n\n  // watchedBtn.removeEventListener('click', onWatchedClick);\n  // queueBtn.removeEventListener('click', onQueueClick);\n}\n\nfunction onCloseButton() {\n  backdropModal.classList.add('is-hidden');\n  //зняття слухачів\n\n\n  // watchedBtn.removeEventListener('click', onWatchedClick);\n  // queueBtn.removeEventListener('click', onQueueClick);\n}\n\nasync function showCard(e) {\n\n  e.preventDefault();\n  console.log(e.target.nodeName);\n\n  if (e.target.nodeName === 'UL') {\n    return;\n  }\n\n  backdropModal.classList.remove('is-hidden');\n\n  const movieId = e.target.id; // Отримали ID картки на яку був клік\n\n\n\n  // Отримуємо дані фільму\n  const movie = await getMovieInfoById(movieId); \n\n  async function getMovieInfoById(movieID) { \n    const resp = await fetch(`https://api.themoviedb.org/3/movie/${movieID}?api_key=${API_KEY}&language=en-US`); \n \n    const respData = await resp.json(); \n\n    return respData;\n}\n\n  // Отримуємо youtube трейлер \n  const youtubeTrailer = await getYoutubeTrailerByMovieId(movieId);\n  console.log(youtubeTrailer);\n\n  async function getYoutubeTrailerByMovieId(movieId) {\n    const response = await fetch(\n      `${API_URL}movie/${movieId}/videos?api_key=${API_KEY}&language=en-US`\n    );\n  \n    const responseData = await response.json();\n    console.log(responseData);\n  \n    if (responseData.results.length > 0){\n      return responseData[\"results\"][0][\"key\"];\n    }\n  \n  \n  }\n\n  // Вивід картки фільму\n  const modal = document.querySelector('.modul-card-to-add');\n\n  createModalCard(modal);\n\n  function createModalCard(cardForModal) {\n\n    cardForModal.innerHTML = `\n    <div class=\"modal__poster-thumb\">\n          <img class=\"modal__poster\" src=\"${API_URL_IMG}${movie.poster_path}\" alt=\"${movie.original_title} poster\">\n        </div>\n   \n        <div class=\"modal__info-thumb\">\n            <h2 class=\"modal__title\">${movie.original_title}</h2>\n        <table class=\"modal__info\">\n            <tr class=\"modal__info-entry\">\n            <td class=\"modal__info-key\">Vote / Votes</td>\n            <td><span class=\"modal__info-value-vote modal__info-value-vote--accent\">${movie.vote_average}</span> / <span class=\"modal__info-value-vote\">${movie.vote_count}</span></td>\n            </tr>\n            <tr class=\"modal__info-entry\">\n                <td class=\"modal__info-key\">Popularity</td>\n                <td class=\"modal__info-value\">${movie.popularity}</td>\n            </tr>\n            <tr class=\"modal__info-entry\">\n                <td class=\"modal__info-key\">Original Title</td>\n                <td class=\"modal__info-value modal__info-value-title\">${movie.original_title}</td>\n        </tr>\n            <tr class=\"modal__info-entry\">\n                <td class=\"modal__info-key\">Genre</td>\n                <td class=\"modal__info-value\">${movie.genres.id}</td>\n            </tr>\n        </table>\n\n        <h3 class=\"modal__about\">About</h3>\n        <p class=\"modal__about-text\">${movie.overview}</p>\n            <div class=\"modal__button-container\">\n                <button id=\"watched\" type=\"button\" class=\"modal__button modal__button-watched\">add to watched</button>\n                <button id=\"queue\" type=\"button\" class=\"modal__button modal__button-queue\">add to queue</button>\n            </div>\n\n            <div class=\"modal__button-trailer-wrap\">\n                <button id=\"trailer\" type=\"button\" class=\"modal__button modal__button-trailer\">Trailer</button>\n\n                <iframe class=\"modal__iframe is-hidden\" width=\"1237\" height=\"696\" src=\"https://www.youtube.com/embed/${youtubeTrailer}\" title=\"Mia and me - Mia and me Day 2014\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" allowfullscreen></iframe>\n            </div>\n        </div>\n    </div>\n  `;\n\n\n    // ПЕРЕВІРКА - чи в списку бібліотеки\n\n    onWatchedCheck()\n    onQueueCheck()\n\n    function onWatchedCheck() {\n      const watchedBtn = document.querySelector(`#watched`);\n      //якщо фільм вже в списку\n      if (watched.includes(movieId)) {\n        watchedBtn.textContent = 'remove from watched'; //змінити текст кнопки\n        return;\n      }\n        watchedBtn.textContent = 'add to watched'; //змінити текст кнопки\n    }\n  \n    function onQueueCheck() {\n          const queueBtn = document.querySelector('#queue');\n      if (queue.includes(movieId)) {\n\n        queueBtn.textContent = 'remove from queue';\n        return;\n      }\n\n      queueBtn.textContent = 'add to queue';\n    };\n\n  };\n\n\n\n    const watchedBtn = document.querySelector(`#watched`);\n    const queueBtn = document.querySelector(`#queue`);\n    // const trailerBtn = document.querySelector(`#trailer`);\n\n\n    watchedBtn.addEventListener('click', onWatchedClick);\n    queueBtn.addEventListener('click', onQueueClick);\n    window.addEventListener('click', onWindowClick);\n \n\n\n\n  function onWatchedClick() {\n    //якщо фільм вже в списку\n    if (watched.includes(movieId)) {\n      watched.splice(watched.indexOf(movieId), 1); //видаляємо з масиву айді\n      setWatched(watched); //перезаписуємо сховище\n      watchedBtn.textContent = 'add to watched'; //змінити текст кнопки\n      renderList(watched);\n      return;\n    }\n\n    watched.push(movieId); //додати в масив айді фільма\n    setWatched(watched); //записати в сховище\n    watchedBtn.textContent = 'remove from watched'; //змінити текст кнопки\n  }\n\n  function onQueueClick() {\n    if (queue.includes(movieId)) {\n      queue.splice(queue.indexOf(movieId), 1);\n      setWatched(queue);\n      queueBtn.textContent = 'add to queue';\n      renderList(queue);\n      return;\n    }\n\n    queue.push(movieId);\n    setQueue(queue);\n    queueBtn.textContent = 'remove from queue';\n  }\n  \n\n\n\n    \n  function onWindowClick(e) {\n    if (!modal.contains(event.target)) {\n      console.log('Трейлер на паузі');\n      document.querySelector('#video').contentWindow.postMessage('{\"event\":\"command\",\"func\":\"pauseVideo\",\"args\":\"\"}', '*');\n   \n      backdropModal.classList.add('is-hidden');\n      watchedBtn.removeEventListener('click', onWatchedClick);\n      queueBtn.removeEventListener('click', onQueueClick);\n      window.removeEventListener('click', onWindowClick);\n    }\n\n  }\n  const modalIframe = document.querySelector('iframe');\n\n  const trailerBtn = document.querySelector(`#trailer`);\n  console.log(trailerBtn);\n  \n  trailerBtn.addEventListener('click', onTrailerClick);\n\n  function onTrailerClick() {\n    modalIframe.classList.remove('is-hidden');\n    console.log('кнопка работает');\n  }\n\n\n};\n"],"names":["$4LMMA","parcelRequire","$65ae57d8cd8194df$var$API_KEY","$65ae57d8cd8194df$var$API_URL","$65ae57d8cd8194df$var$API_URL_IMG","$65ae57d8cd8194df$var$libWatchedBtn","document","querySelector","$65ae57d8cd8194df$var$libQueueBtn","$65ae57d8cd8194df$var$libBoxinfo","$65ae57d8cd8194df$var$BoxCard","$65ae57d8cd8194df$var$spinner","async","$65ae57d8cd8194df$var$onlibWatchedBtnClick","watched","length","console","log","classList","remove","innerHTML","add","$65ae57d8cd8194df$export$4bf387f59bfc6d67","$65ae57d8cd8194df$var$getMoviesList","array","moviePromises","map","item","movieID","resp","fetch","json","$65ae57d8cd8194df$var$getMovieInfoById","Promise","all","watchedList","reduce","acc","test","$kLwDf","getGenrelibrary","genres","id","poster_path","original_title","release_date","substring","$65ae57d8cd8194df$var$createMarkup","$65ae57d8cd8194df$var$createList","insertAdjacentHTML","addEventListener","queue","window","$5274909fd9dfb2b1$var$backdropModal","$5274909fd9dfb2b1$var$API_KEY","$5274909fd9dfb2b1$var$API_URL","$5274909fd9dfb2b1$var$refs","gallerySelector","closeButton","evt","code","e","preventDefault","target","nodeName","movieId","movie","getMovieInfoById","youtubeTrailer","response","responseData","results","getYoutubeTrailerByMovieId","modal","cardForModal","vote_average","vote_count","popularity","overview","watchedBtn","includes","textContent","onWatchedCheck","queueBtn","onQueueCheck","onWatchedClick","splice","indexOf","setWatched","push","onQueueClick","setQueue","onWindowClick","contains","event","contentWindow","postMessage","removeEventListener","modalIframe","trailerBtn"],"version":3,"file":"library.7676a567.js.map"}